<!-- calculate.component.html -->
<div class="calculate-container">
  <!-- Card container -->
<div class="card-container" >
  <div class="single-card-container" *ngFor="let card of cards; let i = index">
<p-card class="calculate-card">
    <!-- Başlık -->
    <ng-template pTemplate="header">
      <div class="card-header">Calculate</div>
    </ng-template>

    <!-- Form başlangıcı -->
    <form [formGroup]="card.form">
      <!-- Kişi seçimi -->
      <div class="person-select">
        <p-dropdown
          [options]="people"
          formControlName="person"
          optionLabel="name"
          optionValue="id"
          placeholder="Kişi Seçin"
        ></p-dropdown>
      </div>
      <hr class="divider" />

      <!-- Ana grid: 5×3 -->
      <div class="grid-main">
        <!-- Yiyecek -->
        <div>
          <p-dropdown
            [options]="foods"
            formControlName="food"
            optionLabel="name"
            optionValue="id"
            placeholder="Yiyecek Seçin"
          ></p-dropdown>
        </div>
        <div class="qty-col">
          <button type="button" class=" minus-button" (click)="decreaseQty('food')">
            <i class="pi pi-minus"></i>
          </button>
          <span>{{ qty.food }}</span>
          <button type="button" class="plus-button" (click)="increaseQty('food')">
            <i class="pi pi-plus"></i>
          </button>
        </div>
        <div>
          <input
            pInputText
            type="text"
            [value]="getLineTotal('food') | number:'1.2-2'"
            readonly
            placeholder="0.00"
            class="price-output"
          />
        </div>

        <!-- İçecek -->
        <div>
          <p-dropdown
            [options]="drinks"
            formControlName="drink"
            optionLabel="name"
            optionValue="id"
            placeholder="İçecek Seçin"
          ></p-dropdown>
        </div>
        <div class="qty-col">
          <button type="button" class=" minus-button" (click)="decreaseQty('drink')">
            <i class="pi pi-minus"></i>
          </button>
          <span>{{ qty.drink }}</span>
          <button type="button" class=" plus-button" (click)="increaseQty('drink')">
            <i class="pi pi-plus"></i>
          </button>
        </div>
        <div>
          <input
            pInputText
            type="text"
            [value]="getLineTotal('drink') | number:'1.2-2'"
            readonly
            placeholder="0.00"
            class="price-output"
          />
        </div>

        <!-- Tatlı -->
        <div>
          <p-dropdown
            [options]="desserts"
            formControlName="dessert"
            optionLabel="name"
            optionValue="id"
            placeholder="Tatlı Seçin"
          ></p-dropdown>
        </div>
        <div class="qty-col">
          <button type="button" class=" minus-button" (click)="decreaseQty('dessert')">
            <i class="pi pi-minus"></i>
          </button>
          <span>{{ qty.dessert }}</span>
          <button type="button" class=" plus-button" (click)="increaseQty('dessert')">
            <i class="pi pi-plus"></i>
          </button>
        </div>
        <div>
          <input
            pInputText
            type="text"
            [value]="getLineTotal('dessert') | number:'1.2-2'"
            readonly
            placeholder="0.00"
            class="price-output"
          />
        </div>

        <!-- Bahşiş -->
        <div class="label-col tip-div"><span>Bahşiş:</span></div>
        <div class="input-div">
          <input
            pInputText
            type="number"
            formControlName="amount"
            placeholder="Miktar"
            class="p-inputtext"
            min="0"
            step="5"
            inputmode="numeric"
            autocomplete="off"
            maxlength="3"
            
          />
        </div>
        <div>
          <input
            pInputText
            type="text"
            [value]="formGroup.value.amount | number:'1.2-2'"
            readonly
            placeholder="0.00"
            class="price-output"
          />
        </div>

        <!-- Hesapla butonu -->
        <div></div>
        <div class="btn-calc-col">
          <button type="button" pButton label="Hesapla" class="p-button-success" (click)="calculateTotal()"></button>
        </div>
        <div></div>
      </div>
    </form>

    <!-- Hesapla’dan sonra çizgi -->
    <hr class="divider divider-after-calc" />

    <!-- Alt footer -->
    <div class="grid-footer">
      <div>
        <span pTooltip="Coming Soon" tooltipPosition="bottom">
        <button pButton label="Kaydet" class="p-button-primary w-full" style="cursor:not-allowed; background-color: var(--btn-color); color: var(--text-color);" (click)="save()"></button>
        </span>
      </div>
      <div class="footer-center"><strong>TOPLAM:</strong>
      <div class="footer-right"><span>{{ total | number:'1.2-2' }} </span><span class="currency">₺</span></div></div>
      
    </div>
  </p-card>
  </div>
  <div class="add-card-div">
   <p-button icon="pi pi-plus" class="add-card-button" (click)="addCard()"></p-button>
  </div>
</div>

</div>

